/**
 * Agent Foundry - Mock Dataset Data
 * Sample datasets and evaluation runs
 */

import { Dataset, Evaluation, EvaluationResult, DatasetVersion, DatasetRow } from '@/types';

export const mockDatasets: Dataset[] = [
  {
    id: 'ds-001',
    name: 'customer-support-test-set',
    description: 'Test dataset for customer support agent with 500 real customer queries',
    type: 'test',
    format: 'jsonl',
    file_url: '/datasets/customer-support-test-set-v1.2.jsonl',
    file_size_bytes: 524288,
    row_count: 500,
    schema: [
      { name: 'query', type: 'string', description: 'Customer question or request', required: true },
      { name: 'expected_intent', type: 'string', description: 'Expected intent classification', required: true },
      { name: 'expected_response', type: 'string', description: 'Expected agent response', required: false },
      { name: 'metadata', type: 'object', description: 'Additional test metadata', required: false },
    ],
    version: '1.2.0',
    versions: [
      {
        id: 'dsv-001',
        dataset_id: 'ds-001',
        version: '1.2.0',
        created_at: '2025-01-10T14:00:00Z',
        created_by: 'nwalker85',
        changelog: 'Added 50 edge cases for order cancellation scenarios',
        file_url: '/datasets/customer-support-test-set-v1.2.jsonl',
        row_count: 500,
        is_current: true,
      },
      {
        id: 'dsv-002',
        dataset_id: 'ds-001',
        version: '1.1.0',
        created_at: '2024-12-15T10:00:00Z',
        created_by: 'nwalker85',
        changelog: 'Initial test set with 450 customer queries',
        file_url: '/datasets/customer-support-test-set-v1.1.jsonl',
        row_count: 450,
        is_current: false,
      },
    ],
    used_by_agents: ['agt-001'],
    last_evaluation_run: '2025-01-15T14:22:00Z',
    last_evaluation_id: 'eval-001',
    evaluation_stats: {
      total_evaluations: 12,
      last_run_at: '2025-01-15T14:22:00Z',
      best_pass_rate: 0.982,
      worst_pass_rate: 0.891,
      avg_pass_rate: 0.942,
      avg_latency_ms: 1823,
      trend: 'improving',
    },
    created_at: '2024-11-01T09:00:00Z',
    updated_at: '2025-01-10T14:00:00Z',
    created_by: 'nwalker85',
    tags: ['customer-support', 'production', 'regression'],
  },
  {
    id: 'ds-002',
    name: 'sales-lead-qualification-eval',
    description: 'Evaluation dataset with 200 lead qualification scenarios',
    type: 'evaluation',
    format: 'json',
    file_url: '/datasets/sales-lead-qualification-v2.0.json',
    file_size_bytes: 262144,
    row_count: 200,
    schema: [
      { name: 'lead_data', type: 'object', description: 'Lead information and context', required: true },
      { name: 'expected_score', type: 'number', description: 'Expected lead score (0-100)', required: true },
      { name: 'expected_action', type: 'string', description: 'Expected routing action', required: true },
    ],
    version: '2.0.0',
    versions: [
      {
        id: 'dsv-003',
        dataset_id: 'ds-002',
        version: '2.0.0',
        created_at: '2025-01-05T11:00:00Z',
        created_by: 'sarah.chen',
        changelog: 'Updated scoring criteria to reflect new sales process',
        file_url: '/datasets/sales-lead-qualification-v2.0.json',
        row_count: 200,
        is_current: true,
      },
    ],
    used_by_agents: ['agt-002'],
    last_evaluation_run: '2025-01-14T16:45:00Z',
    last_evaluation_id: 'eval-002',
    evaluation_stats: {
      total_evaluations: 8,
      last_run_at: '2025-01-14T16:45:00Z',
      best_pass_rate: 0.965,
      worst_pass_rate: 0.875,
      avg_pass_rate: 0.923,
      avg_latency_ms: 2341,
      trend: 'stable',
    },
    created_at: '2024-12-01T10:00:00Z',
    updated_at: '2025-01-05T11:00:00Z',
    created_by: 'sarah.chen',
    tags: ['sales', 'lead-qualification', 'crm'],
  },
  {
    id: 'ds-003',
    name: 'invoice-ocr-validation',
    description: 'Invoice images with ground truth data for OCR accuracy testing',
    type: 'validation',
    format: 'csv',
    file_url: '/datasets/invoice-ocr-validation-v1.0.csv',
    file_size_bytes: 1048576,
    row_count: 150,
    schema: [
      { name: 'image_url', type: 'string', description: 'URL to invoice image', required: true },
      { name: 'ground_truth_total', type: 'number', description: 'Actual invoice total', required: true },
      { name: 'ground_truth_vendor', type: 'string', description: 'Actual vendor name', required: true },
      { name: 'ground_truth_date', type: 'string', description: 'Actual invoice date', required: true },
    ],
    version: '1.0.0',
    versions: [
      {
        id: 'dsv-004',
        dataset_id: 'ds-003',
        version: '1.0.0',
        created_at: '2024-12-28T10:00:00Z',
        created_by: 'alex.kim',
        changelog: 'Initial OCR validation dataset',
        file_url: '/datasets/invoice-ocr-validation-v1.0.csv',
        row_count: 150,
        is_current: true,
      },
    ],
    used_by_agents: ['agt-007'],
    last_evaluation_run: '2025-01-16T08:15:00Z',
    last_evaluation_id: 'eval-003',
    evaluation_stats: {
      total_evaluations: 5,
      last_run_at: '2025-01-16T08:15:00Z',
      best_pass_rate: 0.947,
      worst_pass_rate: 0.812,
      avg_pass_rate: 0.883,
      avg_latency_ms: 3421,
      trend: 'declining',
    },
    created_at: '2024-12-28T10:00:00Z',
    updated_at: '2024-12-28T10:00:00Z',
    created_by: 'alex.kim',
    tags: ['ocr', 'finance', 'validation'],
  },
  {
    id: 'ds-004',
    name: 'sql-query-training-set',
    description: 'Natural language to SQL training examples',
    type: 'training',
    format: 'jsonl',
    file_url: '/datasets/sql-training-v3.1.jsonl',
    file_size_bytes: 2097152,
    row_count: 1000,
    schema: [
      { name: 'question', type: 'string', description: 'Natural language question', required: true },
      { name: 'sql_query', type: 'string', description: 'Correct SQL query', required: true },
      { name: 'database_schema', type: 'object', description: 'Relevant schema info', required: true },
      { name: 'difficulty', type: 'string', description: 'Query difficulty level', required: false },
    ],
    version: '3.1.0',
    versions: [
      {
        id: 'dsv-005',
        dataset_id: 'ds-004',
        version: '3.1.0',
        created_at: '2025-01-16T09:12:00Z',
        created_by: 'mike.rodriguez',
        changelog: 'Added PostgreSQL-specific examples',
        file_url: '/datasets/sql-training-v3.1.jsonl',
        row_count: 1000,
        is_current: true,
      },
    ],
    used_by_agents: ['agt-003'],
    last_evaluation_run: '2025-01-16T10:00:00Z',
    last_evaluation_id: 'eval-004',
    evaluation_stats: {
      total_evaluations: 15,
      last_run_at: '2025-01-16T10:00:00Z',
      best_pass_rate: 0.978,
      worst_pass_rate: 0.834,
      avg_pass_rate: 0.912,
      avg_latency_ms: 4521,
      trend: 'improving',
    },
    created_at: '2024-10-01T08:00:00Z',
    updated_at: '2025-01-16T09:12:00Z',
    created_by: 'mike.rodriguez',
    tags: ['sql', 'analytics', 'training'],
  },
  {
    id: 'ds-005',
    name: 'content-moderation-benchmark',
    description: 'Benchmark dataset for content moderation with 2000 labeled examples',
    type: 'test',
    format: 'parquet',
    file_url: '/datasets/content-moderation-v1.5.parquet',
    file_size_bytes: 4194304,
    row_count: 2000,
    schema: [
      { name: 'content', type: 'string', description: 'User-generated content', required: true },
      { name: 'content_type', type: 'string', description: 'text, image, or video', required: true },
      { name: 'expected_label', type: 'string', description: 'safe, warning, or violation', required: true },
      { name: 'violation_categories', type: 'array', description: 'List of policy violations', required: false },
    ],
    version: '1.5.0',
    versions: [
      {
        id: 'dsv-006',
        dataset_id: 'ds-005',
        version: '1.5.0',
        created_at: '2025-01-15T11:40:00Z',
        created_by: 'emma.davis',
        changelog: 'Added 500 edge cases for borderline content',
        file_url: '/datasets/content-moderation-v1.5.parquet',
        row_count: 2000,
        is_current: true,
      },
    ],
    used_by_agents: ['agt-006'],
    last_evaluation_run: '2025-01-15T12:00:00Z',
    last_evaluation_id: 'eval-005',
    evaluation_stats: {
      total_evaluations: 20,
      last_run_at: '2025-01-15T12:00:00Z',
      best_pass_rate: 0.994,
      worst_pass_rate: 0.976,
      avg_pass_rate: 0.987,
      avg_latency_ms: 687,
      trend: 'stable',
    },
    created_at: '2024-11-10T13:00:00Z',
    updated_at: '2025-01-15T11:40:00Z',
    created_by: 'emma.davis',
    tags: ['moderation', 'safety', 'benchmark'],
  },
  {
    id: 'ds-006',
    name: 'meeting-transcription-samples',
    description: 'Sample meeting transcripts for testing summarization quality',
    type: 'custom',
    format: 'json',
    file_url: '/datasets/meeting-transcripts-v1.0.json',
    file_size_bytes: 3145728,
    row_count: 75,
    schema: [
      { name: 'transcript', type: 'string', description: 'Full meeting transcript', required: true },
      { name: 'duration_minutes', type: 'number', description: 'Meeting duration', required: true },
      { name: 'participants', type: 'array', description: 'List of participants', required: true },
      { name: 'expected_summary', type: 'string', description: 'Human-written summary', required: true },
      { name: 'expected_action_items', type: 'array', description: 'List of action items', required: true },
    ],
    version: '1.0.0',
    versions: [
      {
        id: 'dsv-007',
        dataset_id: 'ds-006',
        version: '1.0.0',
        created_at: '2025-01-14T12:20:00Z',
        created_by: 'chris.patel',
        changelog: 'Initial dataset with 75 meeting transcripts',
        file_url: '/datasets/meeting-transcripts-v1.0.json',
        row_count: 75,
        is_current: true,
      },
    ],
    used_by_agents: ['agt-008'],
    last_evaluation_run: '2025-01-14T13:00:00Z',
    last_evaluation_id: 'eval-006',
    evaluation_stats: {
      total_evaluations: 3,
      last_run_at: '2025-01-14T13:00:00Z',
      best_pass_rate: 0.947,
      worst_pass_rate: 0.920,
      avg_pass_rate: 0.933,
      avg_latency_ms: 5234,
      trend: 'stable',
    },
    created_at: '2025-01-14T12:20:00Z',
    updated_at: '2025-01-14T12:20:00Z',
    created_by: 'chris.patel',
    tags: ['meetings', 'transcription', 'summarization'],
  },
];

export const mockEvaluations: Evaluation[] = [
  {
    id: 'eval-001',
    dataset_id: 'ds-001',
    dataset_name: 'customer-support-test-set',
    agent_id: 'agt-001',
    agent_name: 'customer-support-agent',
    agent_version: '2.1.0',
    started_at: '2025-01-15T14:22:00Z',
    completed_at: '2025-01-15T14:45:23Z',
    duration_ms: 1403000,
    status: 'complete',
    total_tests: 500,
    tests_passed: 491,
    tests_failed: 9,
    pass_rate: 0.982,
    test_results: [], // Would contain 500 detailed results
    avg_latency_ms: 1823,
    total_cost: 1.15,
    avg_cost_per_test: 0.0023,
    baseline_evaluation_id: 'eval-000',
    delta_pass_rate: 0.012,
    delta_latency_ms: -120,
    delta_cost: -0.0003,
  },
  {
    id: 'eval-002',
    dataset_id: 'ds-002',
    dataset_name: 'sales-lead-qualification-eval',
    agent_id: 'agt-002',
    agent_name: 'sales-qualifying-agent',
    agent_version: '1.8.3',
    started_at: '2025-01-14T16:45:00Z',
    completed_at: '2025-01-14T17:12:45Z',
    duration_ms: 1665000,
    status: 'complete',
    total_tests: 200,
    tests_passed: 188,
    tests_failed: 12,
    pass_rate: 0.94,
    test_results: [],
    avg_latency_ms: 2341,
    total_cost: 0.82,
    avg_cost_per_test: 0.0041,
    delta_pass_rate: -0.008,
    delta_latency_ms: 45,
    delta_cost: 0.0008,
  },
  {
    id: 'eval-003',
    dataset_id: 'ds-003',
    dataset_name: 'invoice-ocr-validation',
    agent_id: 'agt-007',
    agent_name: 'invoice-processor-agent',
    agent_version: '2.0.4',
    started_at: '2025-01-16T08:15:00Z',
    completed_at: '2025-01-16T08:23:45Z',
    duration_ms: 525000,
    status: 'complete',
    total_tests: 150,
    tests_passed: 122,
    tests_failed: 28,
    pass_rate: 0.813,
    test_results: [],
    avg_latency_ms: 3421,
    total_cost: 0.78,
    avg_cost_per_test: 0.0052,
    delta_pass_rate: -0.134,
    delta_latency_ms: 234,
    delta_cost: 0.0012,
  },
  {
    id: 'eval-004',
    dataset_id: 'ds-004',
    dataset_name: 'sql-query-training-set',
    agent_id: 'agt-003',
    agent_name: 'data-analyst-agent',
    agent_version: '3.0.1',
    started_at: '2025-01-16T10:00:00Z',
    completed_at: '2025-01-16T11:15:30Z',
    duration_ms: 4530000,
    status: 'complete',
    total_tests: 1000,
    tests_passed: 967,
    tests_failed: 33,
    pass_rate: 0.967,
    test_results: [],
    avg_latency_ms: 4521,
    total_cost: 6.7,
    avg_cost_per_test: 0.0067,
    baseline_evaluation_id: 'eval-003-baseline',
    delta_pass_rate: 0.023,
    delta_latency_ms: -342,
    delta_cost: -0.0011,
  },
  {
    id: 'eval-005',
    dataset_id: 'ds-005',
    dataset_name: 'content-moderation-benchmark',
    agent_id: 'agt-006',
    agent_name: 'content-moderator-agent',
    agent_version: '1.9.0',
    started_at: '2025-01-15T12:00:00Z',
    completed_at: '2025-01-15T12:23:14Z',
    duration_ms: 1394000,
    status: 'complete',
    total_tests: 2000,
    tests_passed: 1988,
    tests_failed: 12,
    pass_rate: 0.994,
    test_results: [],
    avg_latency_ms: 687,
    total_cost: 1.6,
    avg_cost_per_test: 0.0008,
    delta_pass_rate: 0.002,
    delta_latency_ms: -23,
    delta_cost: -0.0001,
  },
  {
    id: 'eval-006',
    dataset_id: 'ds-006',
    dataset_name: 'meeting-transcription-samples',
    agent_id: 'agt-008',
    agent_name: 'meeting-summarizer-agent',
    agent_version: '1.5.7',
    started_at: '2025-01-14T13:00:00Z',
    completed_at: '2025-01-14T13:06:30Z',
    duration_ms: 390000,
    status: 'complete',
    total_tests: 75,
    tests_passed: 71,
    tests_failed: 4,
    pass_rate: 0.947,
    test_results: [],
    avg_latency_ms: 5234,
    total_cost: 0.67,
    avg_cost_per_test: 0.0089,
  },
];

// Sample detailed evaluation results
export const mockEvaluationResults: EvaluationResult[] = [
  {
    id: 'result-001',
    evaluation_id: 'eval-001',
    test_index: 0,
    test_name: 'Order status query - happy path',
    input: { query: 'What is the status of my order #12345?' },
    expected_output: { intent: 'order_status', order_id: '12345' },
    actual_output: { intent: 'order_status', order_id: '12345' },
    status: 'passed',
    latency_ms: 1823,
    tokens_used: 243,
    cost: 0.00035,
    score: 1.0,
    scoring_criteria: {
      intent_accuracy: 1.0,
      response_quality: 0.95,
      latency: 0.92,
    },
  },
  {
    id: 'result-002',
    evaluation_id: 'eval-001',
    test_index: 12,
    test_name: 'Order cancellation - edge case',
    input: { query: 'I want to cancel my order but I lost the order number' },
    expected_output: { intent: 'order_cancellation', requires_clarification: true },
    actual_output: { intent: 'general_inquiry', requires_clarification: false },
    status: 'failed',
    error_message: 'Intent mismatch: expected order_cancellation, got general_inquiry',
    latency_ms: 2134,
    tokens_used: 289,
    cost: 0.00042,
    score: 0.3,
    scoring_criteria: {
      intent_accuracy: 0.0,
      response_quality: 0.6,
      latency: 0.85,
    },
  },
];

// Helper functions
export function getDatasetById(id: string): Dataset | undefined {
  return mockDatasets.find(ds => ds.id === id);
}

export function getDatasetsByType(type: string): Dataset[] {
  return mockDatasets.filter(ds => ds.type === type);
}

export function getDatasetsByAgent(agentId: string): Dataset[] {
  return mockDatasets.filter(ds => ds.used_by_agents.includes(agentId));
}

export function getEvaluationsByDataset(datasetId: string): Evaluation[] {
  return mockEvaluations.filter(evaluation => evaluation.dataset_id === datasetId);
}

export function getEvaluationsByAgent(agentId: string): Evaluation[] {
  return mockEvaluations.filter(evaluation => evaluation.agent_id === agentId);
}

export function getRecentEvaluations(limit: number = 10): Evaluation[] {
  return [...mockEvaluations]
    .sort((a, b) => new Date(b.started_at).getTime() - new Date(a.started_at).getTime())
    .slice(0, limit);
}

export function getDatasetStats() {
  return {
    total_datasets: mockDatasets.length,
    total_rows: mockDatasets.reduce((sum, ds) => sum + ds.row_count, 0),
    total_evaluations: mockEvaluations.length,
    avg_pass_rate:
      mockEvaluations.reduce((sum, evaluation) => sum + evaluation.pass_rate, 0) / mockEvaluations.length,
  };
}
